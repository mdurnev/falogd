#ifndef FA_H
#define FA_H

#include <sys/fanotify.h>

/**************************************************************************************************
* Clean up file system tree
**************************************************************************************************/
void fs_tree_free();

/**************************************************************************************************
* Add file to file system tree
**************************************************************************************************/
int fs_tree_add_file(char* path, pid_t pid, int access);

/**************************************************************************************************
* Print log
**************************************************************************************************/
int fs_tree_print_log(int out_fd, int log_fd);

/**************************************************************************************************
* Init fanotify
**************************************************************************************************/
int init_fanotify(int log_fd);

/**************************************************************************************************
* Adjust fanotify
**************************************************************************************************/
int adjust_fanotify(unsigned int new_fa_events, int log_fd);

/**************************************************************************************************
* Start fanotify event listener thread
**************************************************************************************************/
int start_fanotify_event_listener(int log_fd);

/**************************************************************************************************
* Stop fanotify event listener thread
**************************************************************************************************/
int stop_fanotify_event_listener(int log_fd);

/**************************************************************************************************
* Add file path filtering string
**************************************************************************************************/
void fanotify_filter_add(const char* str, int log_fd);

/**************************************************************************************************
* Remove all path filtering strings
**************************************************************************************************/
void fanotify_filter_clean();

#endif
